{% extends "base.html" %}

{% block title %}
    {% if product %}Edit Product{% else %}Add Product{% endif %}
{% endblock %}

{% block content %}
<h1>
    {% if product %}Edit Product{% else %}Add Product{% endif %}
</h1>
{% if error %}
    <p style="color:red; font-weight:bold;">
        {{ error }}
    </p>
{% endif %}
<form method="post" enctype="multipart/form-data">
    <p>
        {% if brand_options %}
            <label>Brand:<br>
                <select name="brand">
                    <option value="">-- choose brand --</option>
                    {% for b in brand_options %}
                        <option value="{{ b }}"
                            {% if product and product.brand == b %}selected{% endif %}>
                            {{ b }}
                        </option>
                    {% endfor %}
                </select>
                <a href="{{ url_for('brands') }}">Dodaj novi brand</a>
            </label>
        {% else %}
            <label>Brand:<br>
                <input type="text" name="brand"
                    value="{% if product %}{{ product.brand }}{% endif %}">
                <br>
                <small>No brands defined yet. Go to "Brands" first.</small>
            </label>
        {% endif %}
    </p>
    <p>
        {% if categories %}
            <label>Category:<br>
                <select name="category" required>
                    <option value="">-- choose category --</option>
                    {% for cat in categories %}
                        <option value="{{ cat }}"
                            {% if product and product.category == cat %}selected{% endif %}>
                            {{ cat }}
                        </option>
                    {% endfor %}
                </select>
                <a href="{{ url_for('category_defaults') }}">Dodaj novu ketgoriju</a>
            </label>
        {% else %}
            <label>Category:<br>
                <input type="text" name="category"
                       value="{% if product %}{{ product.category }}{% endif %}">
                <br>
                <small>No categories defined yet. Go to "Category Defaults" first.</small>
            </label>
        {% endif %}
    </p>
    <p>
        <label>Name:<br>
            <input type="text" name="name" required
                   value="{% if product %}{{ product.name }}{% endif %}"
                   required>
        </label>
    </p>
    <p>
        <label>Description:<br>
            <textarea name="description" rows="8" cols="80">{% if product %}{{ product.description }}{% endif %}</textarea>
        </label>
    </p>
    <p>
        <label>Photo (JPG, max 800Ã—800):<br>
            {% if product and product.photo_path %}
                Trenutna fotografija: {{ product.photo_path }}<br>
                <img src="{{ url_for('product_image', filename=product.photo_path) }}"
                    style="max-width:120px; max-height:120px;"><br>
            {% endif %}
            <input type="file" name="photo_file" accept="image/jpeg">
        </label>
    </p>
    <p>
        <button type="submit">
            {% if product %}Save changes{% else %}Save{% endif %}
        </button>
    </p>
</form>
{% endblock %}
