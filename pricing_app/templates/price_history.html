{% extends "base.html" %}
{% block title %}Prices - {{ product.name }}{% endblock %}
{% block content %}
<h1>Price history â€“ {{ product.name }}</h1>

<p><strong>Category:</strong> {{ product.category }} | <strong>Brand:</strong> {{ product.brand }}</p>

<p><a href="{{ url_for('new_price', product_id=product.id) }}">Dodaj novu cenu</a></p>

<table border="1" cellpadding="4" class="larg-table" style="text-align: center;">
    <tr>
        <th style="width: 70px;">Datum</th>
        <th>Cena ka nama</th>
        <th>Dodatni tr.</th>
        <th>Uvoz %</th>
        <th>Zarada %</th>
        <th>Dom. tr.</th>
        <th>Ukupno kostanje</th>
        <th>Izracunata cena</th>
        <th>Konacna cena</th>
        <th>Profit</th>
        <th>Popust %</th>
        <th>Cena sa popustom</th>
        <th>Profit (disc)</th>
        <th style="width: 60px;">Actions</th>
    </tr>
    {% for r in prices %}
    <tr>
        <td>
            <a href="{{ url_for('edit_price', product_id=product.id, price_id=r.id) }}">
                {{r.date}}
            </a>
        </td>
        <td>{{ r.base_price | round(2) }}</td>
        <td>{{ r.extras | round(2) }}</td>
        <td>{{ ((r.import_percent or 0) * 100) | round(2) }}</td>
        <td>{{ ((r.margin_percent or 0) * 100) | round(2) }}</td>
        <td>{{ (r.domestic_transport or 0) | round(2) }}</td>
        <td>{{ (r.cost_total or 0) | round(2) }}</td>
        <td>{{ (r.calculated_price or 0) | round(2) }}</td>
        <td>{{ (r.final_price or 0) | round(2) }}</td>
        <td>{{ (r.profit_final or 0) | round(2) }}</td>
        <td>
            {% if r.discount_percent is not none %}
                {{ (r.discount_percent * 100) | round(2) }}
            {% endif %}
        </td>
        <td>
            {% if r.discount_price is not none %}
                {{ r.discount_price | round(2) }}
            {% endif %}
        </td>
        <td>
            {% if r.profit_discount is not none %}
                {{ r.profit_discount | round(2) }}
            {% endif %}
        </td>
            <td>
        <form method="post"
              action="{{ url_for('delete_price', product_id=product.id, price_id=r.id) }}"
              style="display:inline;"
              onsubmit="return confirm('Are you sure you want to delete this price entry?');">
            <button type="submit">Delete</button>
        </form>
    </td>
</tr>

    </tr>
    {% endfor %}
</table>
{% endblock %}
