{# offer_body_inner.html #}

<table class="header-table">
    <tr>
        <td>
            <strong>Customer:</strong><br>
            {{ offer.client_name }}<br>
            {{ offer.client_address }}<br>
            {% if offer.client_email %}E-mail: {{ offer.client_email }}<br>{% endif %}
            {% if offer.client_phone %}Tel: {{ offer.client_phone }}<br>{% endif %}
        </td>
        <td style="text-align:center;">
            <strong>OFFER No. {{ offer.offer_number or offer.id }}</strong><br>
            Date: {{ offer.date | format_date }}<br>
        </td>
    </tr>
</table>

<h3>Offer Items</h3>
<table class="items-table">
    <thead>
        <tr>
            <th class="col-rb">No.</th>
            <th class="col-photo">Image</th>
            <th class="col-desc">Description</th>
            <th class="col-qty">Qty</th>
            <th class="col-unit">Unit Price</th>
            <th class="col-disc">Disc %</th>
            <th class="col-total">Total</th>
        </tr>
    </thead>
    {% for it in items %}
    <tr>
        <td style="text-align:center;">{{ loop.index }}</td>

        <td style="text-align:center;">
            {% if it.item_photo_path %}
            {% if pdf_mode %}
            {% if it.item_photo_uri %}
            <img src="{{ it.item_photo_uri }}" style="max-width: 80px; max-height: 80px;">
            {% endif %}
            {% else %}
            <img src="{{ url_for('product_image', filename=it.item_photo_path) }}"
                style="max-width: 120px; max-height: 120px;">
            {% endif %}
            {% endif %}
        </td>

        <td>
            <strong>{{ it.item_name }}</strong><br>
            <small class="multiline">
                {{ it.item_description }}
            </small>
        </td>

        <td style="text-align:center;">{{ it.quantity }}</td>

        <td style="text-align:right;">
            {{ format_amount(it.unit_price) }}
        </td>

        <td style="text-align:center;">
            {% if it.discount_percent %}{{ (it.discount_percent * 100) | round(1) }}%{% else %}0%{% endif %}
        </td>

        <td style="text-align:right;">
            {{ format_amount(it.line_net) }}
        </td>
    </tr>
    {% endfor %}
</table>

<div class="no-break-block">

    <br>
    <table class="totals-table">
        <tr>
            <td style="width:60%; text-align:left; color: var(--text-muted); font-size: 8.5pt;">
                Prices are in {{ offer.currency or 'EUR' }}.<br>
                {% if offer.currency != 'RSD' and offer.exchange_rate %}
                Calculated in RSD according to the exchange rate <strong>{{ offer.exchange_rate }}</strong> on the day
                of issuing the offer.
                {% endif %}<br>
                PAYMENT TERMS: {{ offer.payment_terms or 'as agreed' }}<br>
                DELIVERY TERMS: {{ offer.delivery_terms or 'as agreed' }}<br>
                OFFER VALIDITY: {{ offer.validity_days or 10 }} days<br>
                <br>
                {% if offer.napomena %}
                <strong>NOTE:</strong> {{ offer.napomena }}<br>
                {% endif %}
            </td>
            <td style="width:40%; text-align:right;">
                <table class="summary-box">
                    <tr>
                        <td style="text-align:right; color: var(--text-muted);">SUBTOTAL:</td>
                        <td style="text-align:right; width: 100px;">{{ format_amount(offer.total_net or 0) }}</td>
                    </tr>
                    <tr>
                        <td style="text-align:right; color: var(--text-muted);">DISCOUNT {{ ((offer.discount_percent or
                            0)
                            * 100) | round(2) }}%:</td>
                        <td style="text-align:right;">{{ format_amount(offer.total_discount or 0) }}</td>
                    </tr>
                    <tr class="total-row">
                        <td style="text-align:right;">TOTAL:</td>
                        <td style="text-align:right;">{{ format_amount(offer.total_net_after_discount or 0) }}</td>
                    </tr>
                    <tr>
                        <td style="text-align:right; color: var(--text-muted);">VAT {{ ((offer.vat_percent or 0) * 100)
                            | round(2) }}%:</td>
                        <td style="text-align:right;">{{ format_amount(offer.total_vat or 0) }}</td>
                    </tr>
                    <tr class="final-total">
                        <td style="text-align:right; font-weight: bold;">AMOUNT DUE:
                        </td>
                        <td style="text-align:right; font-weight: bold;">{{
                            format_amount(offer.total_gross or 0) }}</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    {% if offer.notes %}
    <p style="font-size:12px; white-space:pre-line;">
        {{ offer.notes }}
    </p>
    {% endif %}

    <br><br>
    <table class="footer-table">
        <tr>
            <td style="text-align:left;">
                Date: {{ offer.date | format_date }}
            </td>
            <td style="text-align:right;">
                {# Signature removed #}
            </td>
        </tr>
    </table>

    <p style="text-align:left;">
        <br>
        <strong>THE OFFER IS VALID WITHOUT STAMP AND SIGNATURE</strong>
    </p>

</div>