{% extends "base.html" %}
{% block title %}Offers{% endblock %}

{% block content %}
<h1>Pregled ponuda</h1>

<form method="get" action="{{ url_for('list_offers') }}">
    <p>
        <label>Od datuma:
            <input type="date" name="date_from" value="{{ date_from or '' }}">
        </label>
        &nbsp;&nbsp;
        <label>Do datuma:
            <input type="date" name="date_to" value="{{ date_to or '' }}">
        </label>
    </p>
    <p>
        <label>Pretraga (ime musterije ili broj / ime ponude):<br>
            <input type="text" name="search" value="{{ search_term or '' }}">
        </label>
        <button type="submit">Pretraga</button>
        <a href="{{ url_for('list_offers') }}">Reset pretrage</a>
    </p>
</form>

<table>
    <tr>
        <th>ID</th>
        <th>Broj / ime ponude</th>
        <th>Datum</th>
        <th>Naziv musterije</th>
        <th>Total (gross)</th>
        <th>Actions</th>
    </tr>
    {% for o in offers %}
    <tr>
        <td style="text-align: center;">{{ o.id }}</td>
        <td>{{ o.offer_number or o.id }}</td>
        <td style="text-align: center;">{{ o.date }}</td>
        <td>{{ o.client_name }}</td>
        <td>
            {% if o.total_gross is not none %}
                {{ format_amount(o.total_gross)}} {{ o.currency or '' }}
            {% endif %}
        </td>
        <td style="text-align: center;">
            <a href="{{ url_for('edit_offer', offer_id=o.id) }}">Izmeni</a> |
            <a href="{{ url_for('view_offer', offer_id=o.id) }}" target="_blank">Provera</a> |
            <a href="{{ url_for('offer_pdf', offer_id=o.id) }}" target="_blank">PDF Print</a> |
            <form method="post"
                action="{{ url_for('delete_offer', offer_id=o.id) }}"
                style="display:inline;"
                onsubmit="return confirm('BRISANJE ponude!!! NIJE moguce vracanje nakon BRISANJA!!!.');">
                <button type="submit">Delete</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
